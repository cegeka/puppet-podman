# Reference

<!-- DO NOT EDIT: This document was generated by Puppet Strings -->

## Table of Contents

### Classes

#### Public Classes

* [`podman`](#podman): Manage containers, pods, volumes, and images with podman without a docker daemon

#### Private Classes

* `podman::install`: Install podman packages

### Defined types

* [`podman::container`](#podmancontainer): manage podman container and register as a systemd service
* [`podman::image`](#podmanimage): pull or remove container images
* [`podman::pod`](#podmanpod): Create a podman pod with defined flags
* [`podman::rootless`](#podmanrootless): Enable rootless podman containers to run as a systemd user service.
* [`podman::subgid`](#podmansubgid): Define an entry in the `/etc/subgid` file.
* [`podman::subuid`](#podmansubuid): Manage entries in `/etc/subuid`
* [`podman::volume`](#podmanvolume): Create a podman volume with defined flags

## Classes

### `podman`

Manage containers, pods, volumes, and images with podman without a docker daemon

#### Examples

##### Basic usage

```puppet
include podman
```

##### A rootless Jenkins deployment using hiera

```puppet
podman::subid:
  jenkins:
    subuid: 2000000
    count: 65535
podman::volumes:
  jenkins:
    user: jenkins
podman::containers:
  jenkins:
    user: jenkins
    image: 'docker.io/jenkins/jenkins:lts'
    flags:
      label:
        - purpose=test
      publish:
        - '8080:8080'
        - '50000:50000'
      volume: 'jenkins:/var/jenkins_home'
    service_flags:
      timeout: '60'
    require:
      - Podman::Volume[jenkins]
```

#### Parameters

The following parameters are available in the `podman` class.

##### `podman_pkg`

Data type: `String`

The name of the podman package (default 'podman')

##### `skopeo_pkg`

Data type: `String`

The name of the skopeo package (default 'skopeo')

##### `podman_docker_pkg`

Data type: `Optional[String]`

Optional[String]
The name of the podman-docker package (default 'podman-docker')

##### `pods`

Data type: `Hash`

A hash of pods to manage using [`podman::pod`](#podmanpod)

Default value: `{}`

##### `volumes`

Data type: `Hash`

A hash of volumes to manage using [`podman::volume`](#podmanvolume)

Default value: `{}`

##### `images`

Data type: `Hash`

A hash of images to manage using [`podman::image`](#podmanimage)

Default value: `{}`

##### `containers`

Data type: `Hash`

A hash of containers to manage using [`podman::container`](#podmancontainer)

Default value: `{}`

##### `manage_subuid`

Data type: `Boolean`

Should the module manage the `/etc/subuid` and `/etc/subgid` files (default is true)
The implementation uses [concat](https://forge.puppet.com/puppetlabs/concat) fragments to build
out the subuid/subgid entries.  If you have a large number of entries you may want to manage them
with another method.  You cannot use the `subuid` and `subgid` defined types unless this is `true`.

Default value: ``false``

##### `file_header`

Data type: `String`

Optional header when `manage_subuid` is true.  Ensure you include a leading `#`.
Default file_header is `# FILE MANAGED BY PUPPET`

Default value: `'# FILE MANAGED BY PUPPET'`

##### `match_subuid_subgid`

Data type: `Boolean`

Enable the `subid` parameter to manage both subuid and subgid entries with the same values.
This setting requires `manage_subuid` to be `true` or it will have no effect.
(default is true)

Default value: ``true``

##### `subid`

Data type: `Hash`

A hash of users (or UIDs) with assigned subordinate user ID number and an count.
Implemented by using the `subuid` and `subgid` defined types with the same data.
Hash key `subuid` is the subordinate UID, and `count` is the number of subordinate UIDs

Default value: `{}`

##### `nodocker`

Data type: `Enum['absent', 'file']`

Should the module create the `/etc/containers/nodocker` file to quiet Docker CLI messages.
Values should be either 'file' or 'absent'. (default is 'absent')

Default value: `'absent'`

## Defined types

### `podman::container`

manage podman container and register as a systemd service

#### Examples

##### 

```puppet
podman::container { 'jenkins':
  image         => 'docker.io/jenkins/jenkins',
  user          => 'jenkins',
  flags         => {
                   publish => [
                              '8080:8080',
                              '50000:50000',
                              ],
                   volume  => 'jenkins:/var/jenkins_home',
                   },
  service_flags => { timeout => '60' },
}
```

#### Parameters

The following parameters are available in the `podman::container` defined type.

##### `image`

Data type: `String`

String $image,
Container registry source of the image being deployed.  Required when
`ensure` is `present` but optional when `ensure` is set to `absent`.

Default value: `''`

##### `user`

Data type: `String`

String
Optional user for running rootless containers.  For rootless containers,
the user must also be defined as a puppet resource that includes at least
'uid', 'gid', and 'home' attributes.

Default value: `''`

##### `flags`

Data type: `Hash`

Hash
All flags for the 'podman container create' command are supported via the
'flags' hash parameter, using only the long form of the flag name.  The
container name will be set as the resource name (namevar) unless the 'name'
flag is included in the flags hash.  If the flags for a container resource
are modified the container will be destroyed and re-deployed during the
next puppet run.  This is achieved by storing the complete set of flags as
a base64 encoded string in a container label named `puppet_resource_flags`
so it can be compared with the assigned resource state.

Default value: `{}`

##### `service_flags`

Data type: `Hash`

Hash
When a container is created, a systemd unit file for the container service
is generated using the 'podman generate systemd' command.  All flags for the
command are supported using the 'service_flags" hash parameter, again using
only the long form of the flag names.

Default value: `{}`

##### `command`

Data type: `String`

String
Optional command to be used as the container entry point.

Default value: `''`

##### `ensure`

Data type: `String`

String
State of the automatically generated systemd service for the container.
Valid values are 'running' or 'stopped'.

Default value: `'present'`

##### `enable`

Data type: `Boolean`

Boolean
Status of the automatically generated systemd service for the container.

Default value: ``true``

##### `update`

Data type: `Boolean`

Boolean
When `true`, the container will be redeployed when a new container image is
detected in the container registry.  This is done by comparing the digest
value of the running container image with the digest of the registry image.

Default value: ``true``

### `podman::image`

pull or remove container images

#### Examples

##### 

```puppet
podman::image { 'my_container':
  image => 'my_container:tag',
  flags => {
           creds => 'USERNAME:PASSWORD',
           },
}
```

#### Parameters

The following parameters are available in the `podman::image` defined type.

##### `image`

Data type: `String`

String
The name of the container image to pull, which should be present in a
configured container registry.

##### `ensure`

Data type: `String`

String
State of the resource must be either `present` or `absent`.

Default value: `'present'`

##### `flags`

Data type: `Hash`

Hash
All flags for the 'podman image pull' command are supported, using only the
long form of the flag name.

Default value: `{}`

##### `user`

Data type: `String`

String
Optional user for running rootless containers.  When using this parameter,
the user must also be defined as a Puppet resource and must include the
'uid', 'gid', and 'home'

Default value: `''`

### `podman::pod`

Create a podman pod with defined flags

#### Examples

##### 

```puppet
podman::pod { 'mypod':
  flags => {
           label => 'use=test, app=wordpress',
           }
}
```

#### Parameters

The following parameters are available in the `podman::pod` defined type.

##### `ensure`

Data type: `String`

State of the resource, which must be either 'present' or 'absent'.

Default value: `'present'`

##### `flags`

Data type: `Hash`

All flags for the 'podman pod create' command are supported, using only the
long form of the flag name.  The resource name (namevar) will be used as the
pod name unless the 'name' flag is included in the hash of flags.

Default value: `{}`

##### `user`

Data type: `String`

String
Optional user for running rootless containers.  When using this parameter,
the user must also be defined as a Puppet resource and must include the
'uid', 'gid', and 'home'

Default value: `''`

### `podman::rootless`

Enable rootless podman containers to run as a systemd user service.

### `podman::subgid`

Define an entry in the `/etc/subgid` file.

#### Examples

##### 

```puppet
podman::subgid { 'myuser':
  subgid => 1000000
  count  => 65535
}
```

#### Parameters

The following parameters are available in the `podman::subgid` defined type.

##### `subgid`

Data type: `Integer`

Integer
Numerical subordinate group ID

##### `count`

Data type: `Integer`

Integer
Numerical subordinate group ID count

##### `order`

Data type: `Integer`

Integer
Sequence number for concat fragments#

Default value: `10`

### `podman::subuid`

Manage entries in `/etc/subuid`

#### Examples

##### 

```puppet
podman::subuid { 'namevar':
  subuid => 1000000
  count  => 65535
}
```

#### Parameters

The following parameters are available in the `podman::subuid` defined type.

##### `subuid`

Data type: `Integer`

Integer
Numerical subordinate user ID

##### `count`

Data type: `Integer`

Integer
Numerical subordinate user ID count

##### `order`

Data type: `Integer`

Integer
Sequence number for concat fragments

Default value: `10`

### `podman::volume`

Create a podman volume with defined flags

#### Examples

##### 

```puppet
podman::volume { 'myvolume':
  flags => {
    label => 'use=test, app=wordpress',
  }
}
```

#### Parameters

The following parameters are available in the `podman::volume` defined type.

##### `ensure`

Data type: `String`

State of the resource must be either 'present' or 'absent'.

Default value: `'present'`

##### `flags`

Data type: `Hash`

All flags for the 'podman volume create' command are supported as part of the
'flags' hash, using only the long form of the flag name.  The value for any
defined flag in the 'flags' hash must be entered as a string.
Volume names are created based on the resoure title (namevar)

Default value: `{}`

##### `user`

Data type: `String`

String
Optional user for running rootless containers.  When using this parameter,
the user must also be defined as a Puppet resource and must include the
'uid', 'gid', and 'home'

Default value: `''`

